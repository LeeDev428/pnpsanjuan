{% extends "admin/base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="dashboard-header">
    <h1><i class="fas fa-tachometer-alt"></i> Admin Dashboard</h1>
    <p>System Overview & Management</p>
</div>

<!-- Statistics Cards -->
<div class="stats-grid">
    <div class="stat-card stat-blue">
        <div class="stat-icon">
            <i class="fas fa-users"></i>
        </div>
        <div class="stat-info">
            <h3>{{ total_employees }}</h3>
            <p>Total Employees</p>
        </div>
    </div>
    
    <div class="stat-card stat-purple">
        <div class="stat-icon">
            <i class="fas fa-user-plus"></i>
        </div>
        <div class="stat-info">
            <h3>{{ total_applicants }}</h3>
            <p>Total Applicants</p>
        </div>
    </div>
    
    <div class="stat-card stat-orange">
        <div class="stat-icon">
            <i class="fas fa-clock"></i>
        </div>
        <div class="stat-info">
            <h3>{{ pending_leaves }}</h3>
            <p>Pending Leave Requests</p>
        </div>
    </div>
    
    <div class="stat-card stat-green">
        <div class="stat-icon">
            <i class="fas fa-map-marker-alt"></i>
        </div>
        <div class="stat-info">
            <h3>{{ active_deployments }}</h3>
            <p>Active Deployments</p>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="quick-actions-section">
    <h2><i class="fas fa-bolt"></i> Quick Actions</h2>
    <div class="actions-grid">
        <a href="{{ url_for('admin.users') }}" class="action-card">
            <i class="fas fa-users-cog"></i>
            <h4>Manage Users</h4>
            <p>{{ total_employees + total_applicants + total_admins }} total users</p>
        </a>
        <a href="{{ url_for('admin.recruitment') }}" class="action-card">
            <i class="fas fa-user-tie"></i>
            <h4>Recruitment</h4>
            <p>{{ total_applicants }} applicants</p>
        </a>
        <a href="{{ url_for('admin.leave_applications') }}" class="action-card">
            <i class="fas fa-calendar-check"></i>
            <h4>Leave Applications</h4>
            <p>{{ pending_leaves }} pending</p>
        </a>
        <a href="{{ url_for('admin.deployment') }}" class="action-card">
            <i class="fas fa-map-marked-alt"></i>
            <h4>Deployments</h4>
            <p>{{ active_deployments }} active</p>
        </a>
        <a href="{{ url_for('admin.reports') }}" class="action-card">
            <i class="fas fa-chart-line"></i>
            <h4>Reports</h4>
            <p>View analytics</p>
        </a>
    </div>
</div>

<!-- Recent Activity -->
<div class="activity-section">
    <div class="activity-column">
        <h2><i class="fas fa-calendar-alt"></i> Recent Leave Applications</h2>
        <div class="activity-list">
            {% if recent_leaves %}
                {% for leave in recent_leaves %}
                <div class="activity-item">
                    <div class="activity-icon {{ leave.status|lower }}">
                        <i class="fas fa-calendar-day"></i>
                    </div>
                    <div class="activity-details">
                        <h4>{{ leave.username }}</h4>
                        <p><strong>{{ leave.leave_type }}</strong> - {{ leave.start_formatted }} to {{ leave.end_formatted }}</p>
                        <span class="activity-meta">
                            <span class="status-badge status-{{ leave.status|lower }}">{{ leave.status }}</span>
                            <span>{{ leave.rank or 'N/A' }}</span>
                        </span>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="empty-state">
                    <i class="fas fa-inbox"></i>
                    <p>No recent leave applications</p>
                </div>
            {% endif %}
        </div>
        {% if recent_leaves %}
        <a href="{{ url_for('admin.leave_applications') }}" class="view-all-link">View All Leave Applications →</a>
        {% endif %}
    </div>
    
    <div class="activity-column">
        <h2><i class="fas fa-user-plus"></i> Recent Applicants</h2>
        <div class="activity-list">
            {% if recent_applicants %}
                {% for applicant in recent_applicants %}
                <div class="activity-item">
                    <div class="activity-icon applicant">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="activity-details">
                        <h4>{{ applicant.username }}</h4>
                        <p>{{ applicant.email }}</p>
                        <span class="activity-meta">
                            <span class="time-badge"><i class="fas fa-clock"></i> {{ applicant.registered_date }}</span>
                        </span>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="empty-state">
                    <i class="fas fa-inbox"></i>
                    <p>No recent applicants</p>
                </div>
            {% endif %}
        </div>
        {% if recent_applicants %}
        <a href="{{ url_for('admin.recruitment') }}" class="view-all-link">View All Applicants →</a>
        {% endif %}
    </div>
</div>

<style>
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: white;
    border-radius: 12px;
    padding: 25px;
    display: flex;
    align-items: center;
    gap: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 4px 16px rgba(0,0,0,0.12);
}

.stat-icon {
    width: 70px;
    height: 70px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 32px;
    color: white;
}

.stat-blue .stat-icon {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
}

.stat-purple .stat-icon {
    background: linear-gradient(135deg, #a855f7, #7e22ce);
}

.stat-orange .stat-icon {
    background: linear-gradient(135deg, #f97316, #c2410c);
}

.stat-green .stat-icon {
    background: linear-gradient(135deg, #10b981, #047857);
}

.stat-info h3 {
    margin: 0 0 5px 0;
    font-size: 36px;
    font-weight: 700;
    color: #333;
}

.stat-info p {
    margin: 0;
    font-size: 14px;
    color: #666;
    font-weight: 500;
}

.quick-actions-section {
    margin-bottom: 30px;
}

.quick-actions-section h2 {
    margin: 0 0 20px 0;
    color: #333;
    font-size: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.actions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.action-card {
    background: white;
    border-radius: 10px;
    padding: 20px;
    text-align: center;
    text-decoration: none;
    transition: all 0.3s ease;
    box-shadow: 0 2px 6px rgba(0,0,0,0.06);
    border: 2px solid transparent;
}

.action-card:hover {
    border-color: var(--primary-red);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(220, 38, 38, 0.15);
}

.action-card i {
    font-size: 36px;
    color: var(--primary-red);
    margin-bottom: 10px;
}

.action-card h4 {
    margin: 0 0 8px 0;
    color: #333;
    font-size: 16px;
}

.action-card p {
    margin: 0;
    font-size: 13px;
    color: #666;
}

.activity-section {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 20px;
}

.activity-column h2 {
    margin: 0 0 20px 0;
    color: #333;
    font-size: 18px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.activity-list {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    min-height: 300px;
}

.activity-item {
    display: flex;
    gap: 15px;
    padding: 15px;
    border-bottom: 1px solid #f0f0f0;
    transition: background 0.2s;
}

.activity-item:last-child {
    border-bottom: none;
}

.activity-item:hover {
    background: #f8f9fa;
    border-radius: 8px;
}

.activity-icon {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    flex-shrink: 0;
}

.activity-icon.pending {
    background: #fff3e0;
    color: #f57c00;
}

.activity-icon.approved {
    background: #e8f5e9;
    color: #388e3c;
}

.activity-icon.rejected {
    background: #ffebee;
    color: #d32f2f;
}

.activity-icon.applicant {
    background: #f3e5f5;
    color: #7b1fa2;
}

.activity-details {
    flex: 1;
}

.activity-details h4 {
    margin: 0 0 5px 0;
    font-size: 15px;
    color: #333;
}

.activity-details p {
    margin: 0 0 8px 0;
    font-size: 13px;
    color: #666;
}

.activity-meta {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 12px;
    color: #999;
}

.time-badge {
    display: flex;
    align-items: center;
    gap: 5px;
}

.view-all-link {
    display: block;
    text-align: center;
    padding: 12px;
    background: #f8f9fa;
    border-radius: 8px;
    margin-top: 15px;
    color: var(--primary-red);
    text-decoration: none;
    font-weight: 600;
    font-size: 14px;
    transition: all 0.2s;
}

.view-all-link:hover {
    background: var(--primary-red);
    color: white;
}

.empty-state {
    text-align: center;
    padding: 40px 20px;
    color: #999;
}

.empty-state i {
    font-size: 48px;
    margin-bottom: 12px;
}

.empty-state p {
    margin: 0;
    font-size: 14px;
}
</style>
{% endblock %}
